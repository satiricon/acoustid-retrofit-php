<?php

namespace Satiricon\AcoustId\Tests\Unit;

use PHPUnit\Framework\TestCase;
use Satiricon\AcoustId\AcoustIdService;
use Satiricon\AcoustId\Tests\Provider;
use Tebru\Retrofit\Retrofit;

class AcoustIdServiceTest extends TestCase {

	/** @var Retrofit */
	private $retrofit;

	/** @var \Traversable */
	private $map;

	/** @var AcoustIdService  */
	private $service;

	protected function setUp() : void {
		$this->retrofit = Provider::get(Retrofit::class);
		$this->map = [
			'client' => getenv('API_APP_TOKEN')
		];
		$this->service = $this->retrofit->create(AcoustIdService::class);
	}

	public function testRetrofitReady(){
		$this->assertNotNull($this->retrofit);
		$this->assertTrue($this->retrofit instanceof Retrofit);
	}

	public function testLookup(){
		$queryMap = array_merge([
			'duration' => '174',
			'fingerprint' => 'AQADtMqkJ4qyoRlRZjV-nE_wNriPZ8e140efpWiu47mCkg-YPEp05Ecylmg-YZeO77jR_EiYMBlCSrTw4TweZcWuB5dBnTmS6jry5Dgb9AmR6lXASNEL3Ueeo5cRHaKFUkIezji-J3g4nEdyhD-F5guePJh1XNqOZw9iI1nU7AGjJc1FfMcl9MUl2NLRa0cuJHF34kmeMTgT_EcPfyl64cdzHU-OMGeKZPLxGWMiXXhylAz8YPqOZ4gzIVmeCv1SXCeDMs_RJAtxCn2E5EdOY2Ji4lrjCPn2RVB_pE9D_MTTcMRJj5jzIMeOH9SHuMcrLtnwLEGz9DGm5fjR50iWOoyQM0_wkBOe8DiFO6isQMvDq3iS4DrxDL2Lpg6eI8-hU4YjXsR3PMoUfDSh52gCjVqKsMJ9nEd_NMsfCsXxGclz5MeLorGE57iO7nJgPIenPSiuI7yRsLjxpCjPYN8jkHmyC3uGGMnxRFEyYVYOfwl-HFeLmgqoJvCP7VGMnsec49KXILvWEM6hvDiVhYH_4w_6pGgiSQpeQ96RL6jMB9cfvEW-d5CRxjz6KBMxJxqu7EiWbwh1DUfXLNEKizmeZ3h4RPuQnIcXJ6iTDNeD_MOTOA_UhghfDQ2i57DDGDqe5kEoXTEa6sJ7Yp_RPEd-iF8ehKSN7-gZWMM1pvAVB3vQZHGEXJkIPUd6OiGeDN-OUTvxJEYTJwif44J-PEcZ5kK6S8Fz2EGoZ8elozmXBE8-Hfdu9IoyfD_6TIH7QaHQVD1iMY7wXaidCemhXcxxHz8JfaiQJcsf4UyxLyeeHgm_PEU-FVd45DS0aPQRijk-UQk-ETv8FnyOHw92JI-6FDmFo8SX4-OO606CP4Lz4wjfHEmuSA1ugWtCDk-W49IbHH1EBc3kaLhyzFKOO8hDhkGyHk30o7KEZkm0UBH-42guBX07XLxiPEul4COOKmEPL9lTVM0xRT9R_cghhd0gaVE9pD2Y4ywYecnRJGHK4Edy5PsxLzma6gp6Hk-U44fjqUPu44ku6FKQfviMbymeLJETXNKPB9OroXkbsPww50eYHMnWqziVoBlxffCPS7rQLLmG2BTkBjma0J5QWmmCb_iSGC8ePGSFKyb6F80jxE544j10Uojpw19CHB-arZGJPjryIlnyxXgeNMl0NNeD3ngYMkGzN-gzNDWqlFEkIXY0aD_S6TDRdyhn-B-q13hunEf-orAzaK6KH78Cx5qRh4ngcEtwonaGZHmi7ojFD1UUD82WD_0eNCeOMUyOP8P1CHmkQ0eYfKgSHflyMJS0Ds_RH82FkM0w7keVV6gk8XiWBr2M5hvyHDpzPElvhNSQJj8Sxswy-FGsoDfm5LiSEPzRH82JpOSFOIt03OLRI8x46Jnw4IeO0NkGqhN6XcF4UnhyOLqhP8N5nMLRH80V68iHpMcf-D0eH_sEPkmP4VoqXBKL_CGSS2gPVwkcKf3R4UdPNPnxa7h0xEyiH0llUWiWh0cvHB_yHfqPTwlylPmCJuq44LlxUeiTDL7hxxMO_wi5PlDE5FuE7S1yPMvgisZnBb5RcRGRv0iW6Y7RKsclhQ6F-vARV0TiWUQT8_ijzFiV5DiZMkIvJDyi72gePDnawD-cj8ebBcmS4w3yZFXwB-EDHXmIncrgy-gV3CSDOEnEQ-O0D5FSWjieoumjIIeWP0VMJccjo1EiT6gfVGYIHz57hM6UI7miB829oDaxi7h0PN-D_yiVI0x9nAnxQ2ukD2HsKvhz5Mqhydj2otqbJPgTCSolhH_gRTnx6IsGP-i1wI2QXEecPJh6Cs2jBFy6HV9-7PmCXiTMMUXZ44mEq0Z_NImP2FYGvZdRRkepeYZ-RO_gJI_x5HimED_h-MMT8MO_4Et65Lig94jOC1VOOE1IXDp8PEd6QnsRpznOeng_PGQMHz_xSETOLOhzqHQQrgk7HEdLH56UET9c5vhnBh-aE7-GxEmSHLlyoj_8DH2N3NCDqCl-C7yDXjp8UkN0BeIvhNrQbYcdOsOPm8hz9IHGHBfqNEa-o_lR_MuE50IpXYcbHAjp7NBz5FeCJ-txvnhGwk-O6D6SH9TxLBY8MiWuHbyH5icmsXjQEz7h2_iMJ6ki3EdyFvmLhqTxoylOpNB4dUWe49lxX3g7eNpS48p15MctHT8uHdrDiAkei4KvBNOR5zjBiQ9RH_axHdZUB_f0ED66PseVd0j-REX8ortwfTgv5BIuhN2LbwmqpziT49QH35h6_MZfPPpxPeCHR8mIJKsZ_Mj745JRqcvhRHuI87hz2NpxuNoT9IlSDRdR6cSURAfLYy-J__iMR0eeE9oTpFyGizh1XISPU8JacH_QZxd2_HjOCacT1OoRxoqgekR-PNOFM8uWoDdiEjoRbTLaqeCkHX1MbEL8ROi1Drou5ImCPkdzY8eVC2yiA81TJDvyJBnOCo2uo2wdPMf9IFIC7TyeBvUMz-Gg5Xpwxgm-OKgSpeEh1hz8GT32HM0faOcG7gnAsniWY6cD9bgOscnxHD-ex8IXJYqh57huhF_ht0GPf4iDi_rxKMvR7EF_vIbYRTkiNsTno4m54_lRH_-GK6GQK_EKjVlPNJMyxNWPZ8D3oa-EOwpDmP1APSp63HGRh0iankQlXfDCkMM_PAdvND0e5rikoFmOvj3OFf0j9GfAyUEcj9AZHvkF3ilOGdltITljB5-O5pmCiypFOEyDLs_xL8N9Cdp5NF9ofAmPLzreo7fw4znqrWCzg0su5DjfQXwuRM9FAIE0A0BAgoGiRgBGGAJACQQAE4QZQIxDAgInmCAMEAIMBMYIkgwAABECiHOMMCQAMpQxIAQXAAAkFBZGGiUIIwA7YhwiABkCBACASKQAEIIYIABx3iNMlVEABACoMAQpIAAgRIiFsELKGCSQMwg4oAgAYBjjiCUAOKGYIQqAqgABxEBioEOQGiQEgkQIQAACghGiGAEEAGAMIARgRxlRQhHgkBFMAMIMBggYYhBiiAgABBDCCEQARYQIQSQxygjGCBDIEQIEIMAQoBRQABACiCAcACYYEkJgYIRhzGAACAjOIEGKA4oA4YxxxggoLDCQGAwBAAYQAAAARBAGCDEGEKOZpQAUggQwRhgGqDBAIKCkE8AAJIQRAAxgmCEMAXGIsgQJQ4BgCAhliDCKEWGAIUIpwBAwABACCHGIGaAAMIYA5ik0gAmjhSEIIUUMMEwAAZhBgggggGGECIEVAcRABxFCSAgjrDCIMUeNAEAAIhAAFgKlkICKAOAIM4IJRAgAxoGEIAQAaQUIAghRAAUAkikDDGBAUQYAAZZDAhACBgghkGJIUSSEAQJQSpACRigODCEAEAAAAAYIBBhxhiBkBAJEECCEsoIgBYAAhghjHELKACKYIxASgwQRDCJDADSMGMAIskwCYwAhBEChBELoFGWEAI4SpAywADADgAAEAIUEQQAwoxlxSBAAgBTAGmWMAgAAAiQDDDFCDRIKGaSEAhgKQpwDAjmEgAJIAAKAYwQDI4x0RjmEBMBAAACEAg4AoBSjRiDAGGMIASUIQpgpZARgQBGDCIBCICMAYkIQYxTAACBFASEEOCIJYcRYIogyDFBAhEKGYEIQkgYAQZggiiACmBGOGQCUEYQYi5hgECIBgEFEMGERAEIYAATDQEDAgNDKIAWAAcgABIBASBAmmHQOGACEoIIIgYwwQAFgBCJAMCCIAUIIYIhRTiHmrAgACKIA'
		], $this->map);
		$call = $this->service->lookup(new \ArrayObject($queryMap));
		$result = $call->execute();
		dump($result->body()->__toString());
		sleep(1);
	}


}
